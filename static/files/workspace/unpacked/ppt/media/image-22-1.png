<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1600 900">
  <defs>
    <linearGradient id="bertGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#14b8a6;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#0d9488;stop-opacity:1" />
    </linearGradient>
  </defs>

  <!-- Background -->
  <rect width="1600" height="900" fill="#f8fafc"/>

  <!-- Title -->
  <text x="800" y="45" font-family="Arial, sans-serif" font-size="36" font-weight="bold" fill="#1e293b" text-anchor="middle">
    BERT: Bidirectional Encoder Architecture
  </text>
  <text x="800" y="80" font-family="Arial, sans-serif" font-size="18" fill="#64748b" text-anchor="middle">
    Input Processing with Token, Position, and Segment Embeddings
  </text>

  <!-- Input Tokens Row -->
  <g id="input-tokens">
    <text x="100" y="145" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#475569">Input Tokens:</text>

    <!-- [CLS] -->
    <rect x="100" y="160" width="110" height="50" rx="6" fill="#a855f7" stroke="#7e22ce" stroke-width="2"/>
    <text x="155" y="192" font-family="Arial, sans-serif" font-size="15" font-weight="bold" fill="white" text-anchor="middle">[CLS]</text>

    <!-- Regular tokens -->
    <rect x="220" y="160" width="90" height="50" rx="6" fill="#e2e8f0" stroke="#94a3b8" stroke-width="1.5"/>
    <text x="265" y="192" font-family="Arial, sans-serif" font-size="14" fill="#334155" text-anchor="middle">this</text>

    <rect x="320" y="160" width="90" height="50" rx="6" fill="#e2e8f0" stroke="#94a3b8" stroke-width="1.5"/>
    <text x="365" y="192" font-family="Arial, sans-serif" font-size="14" fill="#334155" text-anchor="middle">teddy</text>

    <rect x="420" y="160" width="90" height="50" rx="6" fill="#e2e8f0" stroke="#94a3b8" stroke-width="1.5"/>
    <text x="465" y="192" font-family="Arial, sans-serif" font-size="14" fill="#334155" text-anchor="middle">bear</text>

    <rect x="520" y="160" width="70" height="50" rx="6" fill="#e2e8f0" stroke="#94a3b8" stroke-width="1.5"/>
    <text x="555" y="192" font-family="Arial, sans-serif" font-size="14" fill="#334155" text-anchor="middle">is</text>

    <rect x="600" y="160" width="90" height="50" rx="6" fill="#e2e8f0" stroke="#94a3b8" stroke-width="1.5"/>
    <text x="645" y="192" font-family="Arial, sans-serif" font-size="14" fill="#334155" text-anchor="middle">cute</text>

    <!-- [SEP] -->
    <rect x="700" y="160" width="110" height="50" rx="6" fill="#a855f7" stroke="#7e22ce" stroke-width="2"/>
    <text x="755" y="192" font-family="Arial, sans-serif" font-size="15" font-weight="bold" fill="white" text-anchor="middle">[SEP]</text>

    <!-- More tokens -->
    <rect x="820" y="160" width="70" height="50" rx="6" fill="#e2e8f0" stroke="#94a3b8" stroke-width="1.5"/>
    <text x="855" y="192" font-family="Arial, sans-serif" font-size="14" fill="#334155" text-anchor="middle">it</text>

    <rect x="900" y="160" width="70" height="50" rx="6" fill="#e2e8f0" stroke="#94a3b8" stroke-width="1.5"/>
    <text x="935" y="192" font-family="Arial, sans-serif" font-size="14" fill="#334155" text-anchor="middle">is</text>

    <rect x="980" y="160" width="90" height="50" rx="6" fill="#e2e8f0" stroke="#94a3b8" stroke-width="1.5"/>
    <text x="1025" y="192" font-family="Arial, sans-serif" font-size="14" fill="#334155" text-anchor="middle">fluffy</text>

    <!-- [SEP] -->
    <rect x="1080" y="160" width="110" height="50" rx="6" fill="#a855f7" stroke="#7e22ce" stroke-width="2"/>
    <text x="1135" y="192" font-family="Arial, sans-serif" font-size="15" font-weight="bold" fill="white" text-anchor="middle">[SEP]</text>

    <!-- Dots for more tokens -->
    <text x="1210" y="192" font-family="Arial, sans-serif" font-size="20" fill="#94a3b8" text-anchor="middle">...</text>
  </g>

  <!-- Embeddings Section -->
  <g id="embeddings">
    <!-- Token Embeddings -->
    <g id="token-emb">
      <rect x="100" y="250" width="200" height="40" rx="6" fill="#dbeafe" stroke="#3b82f6" stroke-width="2"/>
      <text x="200" y="275" font-family="Arial, sans-serif" font-size="15" font-weight="bold" fill="#1e3a8a" text-anchor="middle">Token Embeddings</text>

      <rect x="320" y="250" width="900" height="40" rx="6" fill="#dbeafe" stroke="#3b82f6" stroke-width="1.5"/>
      <text x="770" y="275" font-family="Arial, sans-serif" font-size="13" fill="#1e40af" text-anchor="middle">E([CLS])   E(this)   E(teddy)   E(bear)   E(is)   E(cute)   [SEP]   E(it)   E(is)   E(fluffy)   ...</text>
    </g>

    <!-- Plus -->
    <text x="60" y="330" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#64748b">+</text>

    <!-- Position Embeddings -->
    <g id="pos-emb">
      <rect x="100" y="305" width="200" height="40" rx="6" fill="#d1fae5" stroke="#10b981" stroke-width="2"/>
      <text x="200" y="330" font-family="Arial, sans-serif" font-size="15" font-weight="bold" fill="#065f46" text-anchor="middle">Position Embeddings</text>

      <rect x="320" y="305" width="900" height="40" rx="6" fill="#d1fae5" stroke="#10b981" stroke-width="1.5"/>
      <text x="770" y="330" font-family="Arial, sans-serif" font-size="13" fill="#047857" text-anchor="middle">E(0)        E(1)        E(2)         E(3)       E(4)      E(5)       E(6)     E(7)     E(8)      E(9)        ...</text>
    </g>

    <!-- Plus -->
    <text x="60" y="385" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#64748b">+</text>

    <!-- Segment Embeddings -->
    <g id="seg-emb">
      <rect x="100" y="360" width="200" height="40" rx="6" fill="#fef3c7" stroke="#f59e0b" stroke-width="2"/>
      <text x="200" y="385" font-family="Arial, sans-serif" font-size="15" font-weight="bold" fill="#78350f" text-anchor="middle">Segment Embeddings</text>

      <rect x="320" y="360" width="900" height="40" rx="6" fill="#fef3c7" stroke="#f59e0b" stroke-width="1.5"/>
      <text x="770" y="385" font-family="Arial, sans-serif" font-size="13" fill="#92400e" text-anchor="middle">E(A)       E(A)       E(A)        E(A)      E(A)     E(A)      E(A)     E(B)    E(B)     E(B)       ...</text>
    </g>

    <!-- Equals -->
    <text x="60" y="450" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#1e293b">=</text>

    <!-- Combined -->
    <rect x="100" y="425" width="1120" height="45" rx="6" fill="#94a3b8" stroke="#475569" stroke-width="2"/>
    <text x="660" y="453" font-family="Arial, sans-serif" font-size="15" font-weight="bold" fill="white" text-anchor="middle">Combined Input: Token + Position + Segment</text>
  </g>

  <!-- Arrow down to BERT -->
  <path d="M 660 470 L 660 520" stroke="#475569" stroke-width="4" fill="none" marker-end="url(#arrow-down)"/>

  <!-- BERT Encoder -->
  <g id="bert-encoder">
    <rect x="200" y="530" width="920" height="140" rx="12" fill="url(#bertGrad)" stroke="#0d9488" stroke-width="3"/>
    <text x="660" y="575" font-family="Arial, sans-serif" font-size="28" font-weight="bold" fill="white" text-anchor="middle">BERT Encoder (12 Layers)</text>
    <text x="660" y="610" font-family="Arial, sans-serif" font-size="16" fill="#d1fae5" text-anchor="middle">Each Layer: Self-Attention (Bidirectional) → Feed Forward → LayerNorm</text>
    <text x="660" y="640" font-family="Arial, sans-serif" font-size="14" fill="#ccfbf1" text-anchor="middle">Every token can attend to ALL other tokens (past and future)</text>
  </g>

  <!-- Arrow down to outputs -->
  <path d="M 660 670 L 660 710" stroke="#0d9488" stroke-width="4" fill="none" marker-end="url(#arrow-teal)"/>

  <!-- Output Representations -->
  <g id="outputs">
    <text x="660" y="735" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#475569" text-anchor="middle">Output Representations:</text>

    <!-- [CLS] output -->
    <rect x="200" y="750" width="250" height="60" rx="6" fill="#fae8ff" stroke="#a855f7" stroke-width="2"/>
    <text x="325" y="778" font-family="Arial, sans-serif" font-size="17" font-weight="bold" fill="#581c87" text-anchor="middle">h[CLS]</text>
    <text x="325" y="798" font-family="Arial, sans-serif" font-size="12" fill="#7e22ce">Sentence representation</text>

    <!-- Other token outputs -->
    <rect x="470" y="750" width="80" height="60" rx="6" fill="#f1f5f9" stroke="#94a3b8" stroke-width="1.5"/>
    <text x="510" y="785" font-family="Arial, sans-serif" font-size="15" fill="#334155" text-anchor="middle">h₁</text>

    <rect x="565" y="750" width="80" height="60" rx="6" fill="#f1f5f9" stroke="#94a3b8" stroke-width="1.5"/>
    <text x="605" y="785" font-family="Arial, sans-serif" font-size="15" fill="#334155" text-anchor="middle">h₂</text>

    <rect x="660" y="750" width="80" height="60" rx="6" fill="#f1f5f9" stroke="#94a3b8" stroke-width="1.5"/>
    <text x="700" y="785" font-family="Arial, sans-serif" font-size="15" fill="#334155" text-anchor="middle">h₃</text>

    <text x="765" y="785" font-family="Arial, sans-serif" font-size="20" fill="#94a3b8" text-anchor="middle">...</text>

    <rect x="830" y="750" width="290" height="60" rx="6" fill="#e0e7ff" stroke="#6366f1" stroke-width="1.5"/>
    <text x="975" y="778" font-family="Arial, sans-serif" font-size="14" fill="#312e81" text-anchor="middle">Token representations</text>
    <text x="975" y="798" font-family="Arial, sans-serif" font-size="12" fill="#4338ca">For MLM or downstream tasks</text>
  </g>

  <!-- Arrow from CLS to classification -->
  <path d="M 325 810 L 325 850" stroke="#a855f7" stroke-width="3" fill="none" marker-end="url(#arrow-purple)"/>

  <!-- Classification head -->
  <rect x="200" y="860" width="250" height="50" rx="6" fill="#fae8ff" stroke="#a855f7" stroke-width="2"/>
  <text x="325" y="892" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#581c87" text-anchor="middle">Linear Layer → Class Logits</text>

  <!-- Pre-training Tasks Box -->
  <g id="pretraining">
    <rect x="1260" y="250" width="300" height="400" rx="10" fill="white" stroke="#3b82f6" stroke-width="3"/>

    <!-- Header -->
    <rect x="1260" y="250" width="300" height="50" rx="10" fill="#3b82f6"/>
    <text x="1410" y="282" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="white" text-anchor="middle">Pre-training Tasks</text>

    <!-- MLM -->
    <rect x="1280" y="320" width="260" height="130" rx="8" fill="#dbeafe" stroke="#3b82f6" stroke-width="2"/>
    <text x="1410" y="345" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#1e3a8a" text-anchor="middle">MLM ✓</text>
    <text x="1410" y="365" font-family="Arial, sans-serif" font-size="13" fill="#1e40af" text-anchor="middle">Masked Language Modeling</text>
    <rect x="1290" y="375" width="240" height="1" fill="#93c5fd"/>
    <text x="1410" y="395" font-family="Arial, sans-serif" font-size="12" fill="#1e40af" text-anchor="middle">• 15% of tokens masked</text>
    <text x="1410" y="413" font-family="Arial, sans-serif" font-size="11" fill="#3b82f6" text-anchor="middle">80% → [MASK]</text>
    <text x="1410" y="428" font-family="Arial, sans-serif" font-size="11" fill="#3b82f6" text-anchor="middle">10% → random token</text>
    <text x="1410" y="443" font-family="Arial, sans-serif" font-size="11" fill="#3b82f6" text-anchor="middle">10% → unchanged</text>

    <!-- NSP (crossed out) -->
    <rect x="1280" y="470" width="260" height="90" rx="8" fill="#fecaca" stroke="#dc2626" stroke-width="2" stroke-dasharray="5,3"/>
    <text x="1410" y="497" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#991b1b" text-anchor="middle">NSP ✗</text>
    <text x="1410" y="517" font-family="Arial, sans-serif" font-size="13" fill="#b91c1c" text-anchor="middle">Next Sentence Prediction</text>
    <text x="1410" y="540" font-family="Arial, sans-serif" font-size="11" fill="#dc2626" text-anchor="middle">Dropped in RoBERTa</text>
    <text x="1410" y="555" font-family="Arial, sans-serif" font-size="11" fill="#dc2626" text-anchor="middle">(no performance benefit)</text>

    <!-- Strike through -->
    <line x1="1285" y1="515" x2="1535" y2="515" stroke="#dc2626" stroke-width="3"/>

    <!-- Fine-tuning note -->
    <rect x="1280" y="580" width="260" height="55" rx="8" fill="#f0fdf4" stroke="#10b981" stroke-width="2"/>
    <text x="1410" y="605" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="#065f46" text-anchor="middle">After pre-training:</text>
    <text x="1410" y="625" font-family="Arial, sans-serif" font-size="12" fill="#047857" text-anchor="middle">Fine-tune for specific tasks</text>
  </g>

  <!-- Key Variants Box -->
  <g id="variants">
    <text x="660" y="775" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#1e293b" text-anchor="middle">Key BERT Variants:</text>

    <rect x="1260" y="700" width="300" height="200" rx="10" fill="white" stroke="#64748b" stroke-width="2"/>
    <rect x="1260" y="700" width="300" height="45" rx="10" fill="#64748b"/>
    <text x="1410" y="728" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="white" text-anchor="middle">Popular Variants</text>

    <!-- DistilBERT -->
    <rect x="1280" y="760" width="260" height="40" rx="6" fill="#e0e7ff" stroke="#6366f1" stroke-width="2"/>
    <text x="1410" y="785" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#312e81" text-anchor="middle">DistilBERT: 6 layers, 60% faster</text>

    <!-- RoBERTa -->
    <rect x="1280" y="810" width="260" height="40" rx="6" fill="#dcfce7" stroke="#16a34a" stroke-width="3"/>
    <text x="1410" y="835" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#14532d" text-anchor="middle">RoBERTa: Better training ⭐</text>

    <!-- BERT-base -->
    <rect x="1280" y="860" width="260" height="30" rx="6" fill="#f3e8ff" stroke="#9333ea" stroke-width="2"/>
    <text x="1410" y="880" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="#581c87" text-anchor="middle">BERT-base: 110M params</text>
  </g>

  <!-- Arrow markers -->
  <defs>
    <marker id="arrow-down" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#475569" />
    </marker>
    <marker id="arrow-teal" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#0d9488" />
    </marker>
    <marker id="arrow-purple" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#a855f7" />
    </marker>
  </defs>
</svg>
